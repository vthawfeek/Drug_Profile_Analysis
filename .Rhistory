!brew cask install xquartz
brew cask install xquartz
install.packages("XQuartz")
Auto=read.table("Auto.data")
fix(Auto)
Auto=read.table("Auto.data",header = TRUE)
Auto=read.table("Auto.data",header = TRUE)
print(x)
head(Auto)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
```{r}
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
head(Auto)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
head(Auto)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
head(Auto)
dim(Auto)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
head(Auto)
dim(Auto)
Auto=na.omit(Auto)
dim(Auto)
names(Auto)
plot(Auto$cylinders,Auto$mpg)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
plot(Auto$cylinders,Auto$mpg)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
Auto=read.csv("Auto.csv",header = TRUE,na.strings = "?")
head(Auto)
dim(Auto)
Auto=na.omit(Auto)
dim(Auto)
names(Auto)
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
Auto=read.csv("Auto.data",header = TRUE,na.strings = "?")
#Auto=read.csv("Auto.",header = TRUE,na.strings = "?")
plot(Auto$cylinders,Auto$mpg)
dim(Auto$cylinders)
Auto=read.csv("Auto.csv",header = T,na.strings = "?")
head(Auto)
dim(Auto)
Auto=na.omit(Auto)
dim(Auto)
names(Auto)
Auto=read.csv("Auto.",header = TRUE,na.strings = "?")
Auto=read.csv("Auto.csv",header = TRUE,na.strings = "?")
plot(Auto$cylinders,Auto$mpg)
head(Auto)
Auto=read.csv("Auto.csv",sep = ' ' ,header = T,na.strings = "?")
Auto=read.csv("Auto.csv",sep="/t",header = T,na.strings = "?")
Auto=read.csv("Auto.csv",sep=" ",header = T,na.strings = "?")
Auto=read.csv("Auto.csv",sep="",header = T,na.strings = "?")
head(Auto)
dim(Auto)
Auto=na.omit(Auto)
dim(Auto)
names(Auto)
#Auto=read.csv("Auto.csv",header = TRUE,na.strings = "?")
plot(Auto$cylinders,Auto$mpg)
plot(Auto$cylinders,Auto$mpg)
attach(Auto)
plot(cylinders,mpg)
cylinders=as.factor(cylinders)
cylinders
plot(cylinders,mpg)
plot(cylinders,mpg)
plot(cylinders,mpg,col=red)
plot(cylinders,mpg)
plot(cylinders,mpg,col="red")
plot(cylinders,mpg)
plot(cylinders,mpg,col="red")
plot(cylinders,mpg,col="red",varwidth=T)
plot(cylinders,mpg)
plot(cylinders,mpg,col="red")
plot(cylinders,mpg,col="red",varwidth=T)
plot(cylinders,mpg,col="red",varwidth=T,horizontal=T)
plot(cylinders,mpg)
plot(cylinders,mpg,col="red")
plot(cylinders,mpg,col="red",varwidth=T)
plot(cylinders,mpg,col="red",varwidth=T,horizontal=T)
plot(cylinders,mpg,col="red",varwidth=T,horizontal=T,xlab="cylinders",ylab="mpg")
hist(mpg)
hist(mpg,col=2,breaks=15)
pairs(Auto)
Auto=read.csv("Auto.csv",sep="",header = T,na.strings = "?")
head(Auto)
dim(Auto)
Auto=na.omit(Auto)
dim(Auto)
names(Auto)
pairs(Auto)
#pairs(Auto)
pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
```{r}
mpg
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(mpg + displacement + horsepower + weight + acceleration)
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(mgp)
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(mpg)
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(mpg,displacement)
mpg+displacement
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(c(mpg,displacement))
#pairs(Auto)
#pairs(∼ mpg + displacement + horsepower + weight + acceleration , Auto)
pairs(c(mpg,displacement))
plot(horsepower,mpg)
identify(horsepower,mpg,name)
summary(Auto)
plot(cars)
library(dplyr)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("OmnipathR")
install.packages("igraph")
install.packages("ggraph")
library(dplyr)
library(ggplot2)
library(OmnipathR)
install.packages(OmnipathR)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
## Last release in Bioconductor
BiocManager::install("OmnipathR")
update.packages(ask = FALSE)
install.packages("dplyr")
install.packages("ggplot2")
install.packages("igraph")
install.packages("ggraph")
install.packages("BiocManager")
BiocManager::install("OmnipathR")
BiocManager::install(version='devel')
install.packages("BiocManager")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("igraph")
install.packages("ggraph")
install.packages("BiocManager")
BiocManager::install("OmnipathR")
# Download protein-protein interactions
interactions = import_Omnipath_Interactions() %>% as_tibble()
install.packages("dplyr")
install.packages("ggplot2")
install.packages("igraph")
install.packages("ggraph")
install.packages("BiocManager")
BiocManager::install("OmnipathR")
library(dplyr)
library(ggplot2)
library(OmnipathR)
library(igraph)
library(ggraph)
# Download protein-protein interactions
interactions = import_Omnipath_Interactions() %>% as_tibble()
# Convert to igraph objects:
OPI_g = interaction_graph(interactions = interactions )
# Download protein-protein interactions
interactions = import_omnipath_interactions() %>% as_tibble()
# Convert to igraph objects:
OPI_g = interaction_graph(interactions = interactions )
iinteraction
interaction
interactions
drug_targets <- tibble(drug = c("Cisplatin"), drug_target = c("HMOX1","TP53","CDKN1A"))
View(drug_targets)
View(drug_targets)
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
View(POI)
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
drug_targets <- tibble(in_OP = c("Cisplatin"), drug_target = c("HMOX1","TP53","CDKN1A"))
drug_targets <- tibble(drug_name = c("Cisplatin"), gene_name = c("HMOX1","TP53","CDKN1A"))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("HMOX1","TP53","CDKN1A"))
View(drug_targets)
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
source_nodes
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
View(drug_targets)
View(drug_targets)
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5"))
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
View(drug_targets)
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
View(drug_targets)
View(drug_targets)
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("NFE2L2","HMOX1","BTG2",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1",
"ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("NFKB1"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("CTR1"))
View(drug_targets)
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("TP53"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("CTR2"))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("OCT2"))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("CDKNIA"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("TP53"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("CDKN1A"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("TP53"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
interactions = import_omnipath_interactions() %>% as_tibble()
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("ATOX1"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("TP53"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("A2M"))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
POI = tibble(protein = c("TP53"))
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
test1 <- import_dorothea_interactions(resources=c("DoRothEA_A",
"ARACNe-GTEx_DoRothEA"), organism=9606)
install.packages('curl')
test1 <- import_dorothea_interactions(resources=c("DoRothEA_A",
"ARACNe-GTEx_DoRothEA"), organism=9606)
View(test1)
TF_Interaction <- import_dorothea_interactions(resources=c("DoRothEA_A", "ARACNe-GTEx_DoRothEA"), organism=9606)
TF_Interaction$source
TF_Interaction$source_genesymbol
class(TF_Interaction$source_genesymbol)
unique(unlist(strsplit(TF_Interaction, " ")))
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
# POI = tibble(protein = c("TP53"))
POI = TF_Interaction$source_genesymbol
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
a <- c(1,2,3)
class(a)
a <- c('1','2','3')
class(a)
# POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
# POI = tibble(protein = c("TP53"))
POI = tibble(protein = TF_Interaction$source_genesymbol)
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
class(TF_Interaction$source_genesymbol)
TF_Interaction$source_genesymbol
# drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("TP53","CDKN1A","NFKB1"))
drug_targets <- tibble(drug_name = c("Cisplatin"), in_OP = c(TRUE),  gene_name = c("A2M"))
POI = tibble(protein = c("NFE2L2","HMOX1","TP53","CDKN1A","BTG2","NFKB1","ICAM1","HSPA5", "ATF4","DDIT3","XBP1"))
#POI = tibble(protein = c("TP53"))
#install.packages('curl')
#TF_Interaction <- import_dorothea_interactions(resources=c("DoRothEA_A", "ARACNe-GTEx_DoRothEA"), organism=9606)
#POI = tibble(protein = TF_Interaction$source_genesymbol)
POI <- POI %>% mutate(in_OP = protein %in% interactions$target_genesymbol)
# all POI is in Omnipath
print(all(POI$in_OP))
source_nodes <- drug_targets %>% filter(in_OP, drug_name=="Cisplatin") %>% pull(gene_name)
target_nodes <- POI %>% filter(in_OP) %>% pull(protein)
collected_path_nodes = list()
for(i_source in 1:length(source_nodes)){
paths <- shortest_paths(OPI_g, from = source_nodes[[i_source]],
to = target_nodes,
output = 'vpath')
path_nodes <- lapply(paths$vpath,names) %>% unlist() %>% unique()
collected_path_nodes[[i_source]] <- path_nodes
}
collected_path_nodes <- unlist(collected_path_nodes) %>% unique()
cisplatin_nodes <- c(source_nodes,target_nodes, collected_path_nodes) %>% unique()
cisplatin_network <- induced_subgraph(graph = OPI_g,vids = cisplatin_nodes)
V(cisplatin_network)$node_type = ifelse(V(cisplatin_network)$name %in% source_nodes, "direct drug target",
ifelse(V(cisplatin_network)$name %in% target_nodes, "POI","intermediate node"))
ggraph(cisplatin_network,layout = "lgl") +
geom_edge_link(aes(start_cap = label_rect(node1.name),
end_cap = label_rect(node2.name)),
arrow = arrow(length = unit(4, 'mm'))) +
geom_node_point() +
geom_node_label(aes(label=name,color=node_type)) +
theme_bw() + xlab("") + ylab("") + ggtitle("Cisplatin induced network")
